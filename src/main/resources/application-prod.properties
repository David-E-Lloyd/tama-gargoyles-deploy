# ----------------------------
# DATABASE (Production - Neon)
# ----------------------------
spring.datasource.url=${DB_URL}
spring.datasource.username=${DB_USERNAME}
spring.datasource.password=${DB_PASSWORD}

# Keep Flyway active to auto-create tables in the new Neon DB
spring.flyway.baseline-on-migrate=true

# ----------------------------
# AUTH0 & SPRING SECURITY
# ----------------------------
# Map these to environment variables
spring.security.oauth2.client.registration.auth0.client-id=${AUTH0_CLIENT_ID}
spring.security.oauth2.client.registration.auth0.client-secret=${AUTH0_CLIENT_SECRET}
spring.security.oauth2.client.registration.auth0.scope=openid,profile,email
spring.security.oauth2.client.registration.auth0.authorization-grant-type=authorization_code
spring.security.oauth2.client.registration.auth0.redirect-uri={baseUrl}/login/oauth2/code/{registrationId}

# Note: Ensure the ENV variable for issuer-uri includes 'https://'
spring.security.oauth2.client.provider.auth0.issuer-uri=${AUTH0_ISSUER_URI}

# If you use the Auth0 library alongside Spring Security
auth0.domain=${AUTH0_DOMAIN}
auth0.client-id=${AUTH0_CLIENT_ID}

# ----------------------------
# CRITICAL FOR RENDER DEPLOYMENT
# ----------------------------
# Render terminates SSL (HTTPS) before the request hits your app.
# This setting tells Spring Boot to trust the "X-Forwarded-Proto" headers from Render.
# Without this, Spring Security will redirect to 'http://' and Auth0 will fail.
server.forward-headers-strategy=native