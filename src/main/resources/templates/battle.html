<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Battle Mode</title>
</head>
<body>
<header>
    <h1>Battle Mode</h1>
    <p>Turn-based battle (MVP) — first to 3 wins.</p>
    <hr />
</header>

<main>

    <!-- YOUR GARGOYLE (from controller) -->
    <section>
        <h2 th:text="${gargoyle.name}">Your Gargoyle</h2>
        <p>
            <strong>Type:</strong> <span th:text="${gargoyle.type}">CHILD</span>
            |
            <strong>Status:</strong> <span th:text="${gargoyle.status}">ACTIVE</span>
        </p>
    </section>

    <hr />

    <!-- SCOREBOARD -->
    <section>
        <h3>Score</h3>
        <p>
            <strong>You:</strong> <span th:text="${state.userScore}">0</span>
            |
            <strong>Opponent:</strong> <span th:text="${state.opponentScore}">0</span>
        </p>
    </section>

    <!-- LAST TURN -->
    <section>
        <h3>Last Turn</h3>

        <div th:if="${state.lastUserMove != null}">
            <p>
                <strong>You played:</strong> <span th:text="${state.lastUserMove}">SLAM</span><br/>
                <strong>Opponent played:</strong> <span th:text="${state.lastOpponentMove}">DASH</span><br/>
                <strong>Outcome:</strong> <span th:text="${state.lastOutcome}">USER_WINS</span>
            </p>
        </div>

        <div th:if="${state.lastUserMove == null}">
            <p>No turns yet — choose an attack!</p>
        </div>
    </section>

    <hr />

    <!-- WINNER MESSAGE -->
    <section th:if="${winnerText != null}">
        <h2 th:text="${winnerText}">Winner message</h2>
    </section>

    <!-- ACTIONS -->
    <section>
        <h3>Choose Attack</h3>

        <!-- Disable buttons if battle finished -->
        <div th:if="${!state.finished}">
            <form th:action="@{/battle/move}" method="post" style="display:inline;">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                <input type="hidden" name="move" value="SLAM"/>
                <button type="submit">Slam</button>
            </form>

            <form th:action="@{/battle/move}" method="post" style="display:inline;">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                <input type="hidden" name="move" value="SNEAK"/>
                <button type="submit">Sneak Attack</button>
            </form>

            <form th:action="@{/battle/move}" method="post" style="display:inline;">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                <input type="hidden" name="move" value="DASH"/>
                <button type="submit">Dash</button>
            </form>
        </div>

        <div th:if="${state.finished}">
            <p><strong>Battle finished.</strong> Reset to play again.</p>
        </div>

        <form th:action="@{/battle/reset}" method="post" style="margin-top: 1rem;">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
            <button type="submit">Reset Battle</button>
        </form>

        <hr />

        <p style="font-size: 0.9em;">
            <strong>Rules (MVP mapping):</strong><br/>
            SLAM (Strength) beats DASH (Speed)<br/>
            DASH (Speed) beats SNEAK (Intelligence)<br/>
            SNEAK (Intelligence) beats SLAM (Strength)<br/>
            Same move = draw (we can upgrade to “higher stat wins” later).
        </p>
    </section>

</main>

<footer>
    <hr />
    <p style="font-size: 0.9em;">Battle MVP page. Styling can be replaced with Tailwind/DaisyUI later.</p>
</footer>
</body>
</html>
